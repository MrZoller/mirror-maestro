<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mirror Maestro - Dashboard (Dark Mode)</title>
    <link rel="stylesheet" href="../../app/static/css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <header>
        <div class="container">
            <h1>Mirror Maestro</h1>
            <p>Orchestrate GitLab mirrors across multiple instance pairs with precision</p>
            <button id="dark-mode-toggle" class="dark-mode-toggle" title="Toggle dark mode" aria-label="Toggle dark mode">
                <span class="theme-icon theme-icon-light">‚òÄÔ∏è</span>
                <span class="theme-icon theme-icon-dark">üåô</span>
            </button>
        </div>
    </header>

    <div class="container">
        <!-- Navigation Tabs -->
        <div class="tabs">
            <button class="tab active" data-tab="dashboard-tab">Dashboard</button>
            <button class="tab" data-tab="instances-tab">GitLab Instances</button>
            <button class="tab" data-tab="pairs-tab">Instance Pairs</button>
            <button class="tab" data-tab="topology-tab">Topology</button>
            <button class="tab" data-tab="mirrors-tab">Mirrors</button>
            <button class="tab" data-tab="help-tab">Help</button>
        </div>

        <!-- Dashboard Tab -->
        <div id="dashboard-tab" class="tab-content active">
            <div class="dashboard-stats">
                <div class="stat-card stat-card-primary">
                    <div class="stat-label">Total Mirrors</div>
                    <div class="stat-value" id="dashboard-total-mirrors">247</div>
                    <div class="stat-sublabel">Across 5 instance pairs</div>
                </div>
                <div class="stat-card stat-card-success">
                    <div class="stat-label">Health</div>
                    <div class="stat-value" id="dashboard-health">94.3<span class="stat-unit">%</span></div>
                    <div class="stat-sublabel">233 mirrors healthy</div>
                </div>
                <div class="stat-card stat-card-danger">
                    <div class="stat-label">Failed</div>
                    <div class="stat-value" id="dashboard-failed">8</div>
                    <div class="stat-sublabel">Needs attention</div>
                </div>
                <div class="stat-card stat-card-warning">
                    <div class="stat-label">Syncing Now</div>
                    <div class="stat-value stat-value-pulse" id="dashboard-syncing">3</div>
                    <div class="stat-sublabel">Updates in progress</div>
                </div>
            </div>

            <div class="dashboard-grid">
                <div class="card">
                    <div class="card-header">
                        <h3>Recent Activity</h3>
                        <span class="text-muted">Last 24 hours</span>
                    </div>
                    <div class="activity-list" id="dashboard-recent-activity">
                        <div class="activity-item">
                            <div class="activity-icon activity-icon-success">‚úì</div>
                            <div class="activity-content">
                                <div class="activity-title">my-group/api-service</div>
                                <div class="activity-meta">Synced successfully ¬∑ 5m ago</div>
                            </div>
                            <span class="badge badge-success">success</span>
                        </div>
                        <div class="activity-item">
                            <div class="activity-icon activity-icon-success">‚úì</div>
                            <div class="activity-content">
                                <div class="activity-title">platform/frontend-app</div>
                                <div class="activity-meta">Synced successfully ¬∑ 12m ago</div>
                            </div>
                            <span class="badge badge-success">success</span>
                        </div>
                        <div class="activity-item">
                            <div class="activity-icon activity-icon-created">‚ú®</div>
                            <div class="activity-content">
                                <div class="activity-title">tools/deployment-scripts</div>
                                <div class="activity-meta">Created ¬∑ 28m ago</div>
                            </div>
                            <span class="badge badge-info">pending</span>
                        </div>
                        <div class="activity-item">
                            <div class="activity-icon activity-icon-error">‚úó</div>
                            <div class="activity-content">
                                <div class="activity-title">infra/kubernetes-configs</div>
                                <div class="activity-meta">Failed to sync ¬∑ 1h ago</div>
                            </div>
                            <span class="badge badge-danger">failed</span>
                        </div>
                        <div class="activity-item">
                            <div class="activity-icon activity-icon-success">‚úì</div>
                            <div class="activity-content">
                                <div class="activity-title">docs/technical-docs</div>
                                <div class="activity-meta">Synced successfully ¬∑ 2h ago</div>
                            </div>
                            <span class="badge badge-success">success</span>
                        </div>
                        <div class="activity-item">
                            <div class="activity-icon activity-icon-updated">‚Üª</div>
                            <div class="activity-content">
                                <div class="activity-title">mobile/ios-app</div>
                                <div class="activity-meta">Updated ¬∑ 3h ago</div>
                            </div>
                            <span class="badge badge-success">success</span>
                        </div>
                    </div>
                </div>

                <div class="dashboard-sidebar">
                    <div class="card">
                        <div class="card-header">
                            <h3>Health Distribution</h3>
                        </div>
                        <div class="health-chart">
                            <canvas id="health-chart"></canvas>
                        </div>
                        <div class="health-legend">
                            <div class="health-legend-item">
                                <span class="health-legend-dot health-legend-dot-success"></span>
                                <span>Success: 233</span>
                            </div>
                            <div class="health-legend-item">
                                <span class="health-legend-dot health-legend-dot-danger"></span>
                                <span>Failed: 8</span>
                            </div>
                            <div class="health-legend-item">
                                <span class="health-legend-dot health-legend-dot-warning"></span>
                                <span>Pending: 6</span>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h3>Mirrors by Pair</h3>
                        </div>
                        <div class="pairs-distribution">
                            <div class="pairs-item">
                                <div class="pairs-name">Production ‚Üí Staging</div>
                                <div class="pairs-bar">
                                    <div class="pairs-bar-fill" style="width: 100%"></div>
                                </div>
                                <div class="pairs-count">89</div>
                            </div>
                            <div class="pairs-item">
                                <div class="pairs-name">GitLab.com ‚Üí Internal</div>
                                <div class="pairs-bar">
                                    <div class="pairs-bar-fill" style="width: 85%"></div>
                                </div>
                                <div class="pairs-count">76</div>
                            </div>
                            <div class="pairs-item">
                                <div class="pairs-name">Dev ‚Üí Test</div>
                                <div class="pairs-bar">
                                    <div class="pairs-bar-fill" style="width: 62%"></div>
                                </div>
                                <div class="pairs-count">55</div>
                            </div>
                            <div class="pairs-item">
                                <div class="pairs-name">Internal ‚Üí Backup</div>
                                <div class="pairs-bar">
                                    <div class="pairs-bar-fill" style="width: 31%"></div>
                                </div>
                                <div class="pairs-count">27</div>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h3>Quick Actions</h3>
                        </div>
                        <div class="quick-actions">
                            <button class="btn btn-primary btn-block">Create New Mirror</button>
                            <button class="btn btn-secondary btn-block">Add Instance</button>
                            <button class="btn btn-secondary btn-block">Import Configuration</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize Chart.js doughnut chart
        window.addEventListener('DOMContentLoaded', () => {
            const ctx = document.getElementById('health-chart');
            if (ctx && typeof Chart !== 'undefined') {
                new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Success', 'Failed', 'Pending'],
                        datasets: [{
                            data: [233, 8, 6],
                            backgroundColor: [
                                'rgba(16, 133, 72, 0.8)',
                                'rgba(221, 43, 14, 0.8)',
                                'rgba(222, 126, 0, 0.8)'
                            ],
                            borderWidth: 0
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        const label = context.label || '';
                                        const value = context.parsed || 0;
                                        const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                        const percentage = ((value / total) * 100).toFixed(1);
                                        return `${label}: ${value} (${percentage}%)`;
                                    }
                                }
                            }
                        },
                        cutout: '65%'
                    }
                });
            }
        });
    </script>
</body>
</html>
