# ==============================================================================
# SECURITY NOTE: Change all default passwords before production deployment!
# - AUTH_PASSWORD (default: changeme)
# - INITIAL_ADMIN_PASSWORD (default: changeme)
# - POSTGRES_PASSWORD (default: postgres)
# The application will log warnings at startup if default credentials are detected.
# ==============================================================================

# Server Configuration
HOST=0.0.0.0
PORT=8000

# Database Configuration (PostgreSQL)
DATABASE_URL=postgresql+asyncpg://postgres:postgres@localhost:5432/mirror_maestro

# PostgreSQL credentials (used by docker-compose)
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=mirror_maestro

# Database Connection Pool Settings (for production tuning)
# DB_POOL_SIZE=20           # Number of persistent connections
# DB_POOL_MAX_OVERFLOW=40   # Additional connections under load
# DB_POOL_RECYCLE=3600      # Recycle connections after N seconds
# DB_POOL_PRE_PING=true     # Test connections before use

# Authentication (optional, single-user mode)
AUTH_ENABLED=true
AUTH_USERNAME=admin
AUTH_PASSWORD=changeme

# Multi-User Mode (optional, JWT-based authentication)
# When enabled, individual user accounts can be created
MULTI_USER_ENABLED=false
# Initial admin user (created on first startup when multi-user mode is enabled)
INITIAL_ADMIN_USERNAME=admin
INITIAL_ADMIN_PASSWORD=changeme
INITIAL_ADMIN_EMAIL=
# JWT Settings
# JWT secret is auto-generated and persisted to ./data/jwt_secret.key if not set
# Override with environment variable for containers or custom locations:
# JWT_SECRET_KEY=your-secret-key-here
# JWT_SECRET_KEY_PATH=/path/to/jwt_secret.key
# JWT_ALGORITHM=HS256
# JWT_EXPIRATION_HOURS=24

# Logging
LOG_LEVEL=INFO

# Application Settings
APP_TITLE=Mirror Maestro
APP_DESCRIPTION=Orchestrate GitLab mirrors across multiple instance pairs with precision

# SSL/TLS Configuration
# Set to true to enable HTTPS with SSL/TLS
SSL_ENABLED=false
# Paths to SSL certificate files (inside container)
SSL_CERT_PATH=/etc/nginx/ssl/cert.pem
SSL_KEY_PATH=/etc/nginx/ssl/key.pem
# Optional: Customize ports (default: 80 for HTTP, 443 for HTTPS)
HTTP_PORT=80
HTTPS_PORT=443

# Rate Limiting (for batch operations and imports)
# Delay between GitLab API operations to avoid overwhelming instances
# Default: 200ms = ~300 operations/minute (well under GitLab's typical 600/min limit)
GITLAB_API_DELAY_MS=200
# Number of retries on rate limit errors (with exponential backoff)
GITLAB_API_MAX_RETRIES=3
# Timeout for GitLab API requests in seconds
GITLAB_API_TIMEOUT=60

# Issue Sync Configuration
# Circuit breaker settings for GitLab API resilience
CIRCUIT_BREAKER_FAILURE_THRESHOLD=5
CIRCUIT_BREAKER_RECOVERY_TIMEOUT=60
# Pagination limits to prevent memory exhaustion
MAX_ISSUES_PER_SYNC=10000
MAX_PAGES_PER_REQUEST=100
# Attachment handling (max size in MB, 0 = unlimited)
MAX_ATTACHMENT_SIZE_MB=100
ATTACHMENT_DOWNLOAD_TIMEOUT=30
# Batch processing (issues per checkpoint)
ISSUE_BATCH_SIZE=50
# Graceful shutdown timeout in seconds
SYNC_SHUTDOWN_TIMEOUT=300
